---
import Layout from "@/layouts/Layout.astro";
import { Image } from "astro:assets";
import { getCollection, getEntry } from "astro:content";

let posts = await getCollection("blog");
posts = posts.filter((acc) => acc.data.draft !== true);
---

<Layout
	title="Blog"
	description="The Official Blog for Naparajith, a Software Engineer from India"
>
	<div class="flex flex-row flex-wrap justify-evenly ~gap-2/4">
		{
			posts.map(async (post) => (
				<a
					href={`/blog/${post.id}`}
					class="flex w-full flex-col justify-evenly border border-border decoration-transparent"
				>
					<article class="flex justify-between text-white/60 ~p-2/4">
						<small>{post.data.created.toDateString()}</small>
						<small>
							{(await getEntry(post.data.author)).data.name}
						</small>
					</article>
					<div>
						<Image
							src={post.data.image}
							alt={post.data.title}
							inferSize
							width={1920}
							height={1080}
							loading={"eager"}
							class="-my-px"
						/>
					</div>
					<article class="flex flex-col ~gap-2/4 ~p-2/4">
						<h4 class="-my-px">{post.data.title}</h4>
						<small class="-my-px truncate">
							{post.data.description}
						</small>
					</article>
				</a>
			))
		}
	</div>
</Layout>
